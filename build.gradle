apply plugin: 'java'

repositories {
    jcenter()
}

sourceCompatibility = 1.8
targetCompatibility = 1.8
version = '1.0.0'

project.ext.jsonSimpleVersion = '1.1.1'
project.ext.gsonVersion = '2.8.5'
project.ext.jacksonVersion = '2.9.7'

dependencies {
    compileOnly group: 'com.googlecode.json-simple', name: 'json-simple', version: jsonSimpleVersion
	compileOnly group: 'com.google.code.gson', name: 'gson', version: gsonVersion
	compileOnly group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: jacksonVersion
	compile group: 'org.apache.commons', name: 'commons-lang3', version: '3.4'

    testCompile group: 'junit', name: 'junit', version: '4.12'
}

configurations {
	jsonSimpleTestCompile.extendsFrom testCompile
	jsonSimpleTestCompileOnly.extendsFrom compileOnly
	gsonTestCompile.extendsFrom testCompile
	gsonTestCompileOnly.extendsFrom compileOnly
	jacksonTestCompile.extendsFrom testCompile
	jacksonTestCompileOnly.extendsFrom compileOnly
}

sourceSets {
    jsonSimpleTest {
    	java {
            srcDirs = [
                "$projectDir/src/main/java",
                "$projectDir/src/test/java"
            ]
            exclude '**/GSONFormatterTest.java'
            exclude '**/JacksonFormatterTest.java'
        }
		resources.srcDir file('src/test/resources')
    }
    
    gsonTest {
    	java {
            srcDirs = [
                "$projectDir/src/main/java",
                "$projectDir/src/test/java"
            ]
            exclude '**/JSONSimpleFormatterTest.java'
            exclude '**/JacksonFormatterTest.java'
        }
		resources.srcDir file('src/test/resources')
    }
    
    jacksonTest {
    	java {
            srcDirs = [
                "$projectDir/src/main/java",
                "$projectDir/src/test/java"
            ]
            exclude '**/JSONSimpleFormatterTest.java'
            exclude '**/GSONFormatterTest.java'
        }
		resources.srcDir file('src/test/resources')
    }
}

dependencies {
	jsonSimpleTestCompile group: 'com.googlecode.json-simple', name: 'json-simple', version: jsonSimpleVersion
	gsonTestCompile group: 'com.google.code.gson', name: 'gson', version: gsonVersion
	jacksonTestCompile group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: jacksonVersion
}

task jsonSimpleTest(type: Test) {
	description = "Test json-simple"
    testClassesDirs = project.sourceSets.jsonSimpleTest.output.classesDirs
	classpath = project.sourceSets.jsonSimpleTest.runtimeClasspath
}

task gsonTest(type: Test) {
	description = "Test gson"
    testClassesDirs = project.sourceSets.gsonTest.output.classesDirs
	classpath = project.sourceSets.gsonTest.runtimeClasspath
}

task jacksonTest(type: Test) {
	description = "Test jackson"
    testClassesDirs = project.sourceSets.jacksonTest.output.classesDirs
	classpath = project.sourceSets.jacksonTest.runtimeClasspath
}

check.dependsOn jsonSimpleTest
check.dependsOn gsonTest
check.dependsOn jacksonTest